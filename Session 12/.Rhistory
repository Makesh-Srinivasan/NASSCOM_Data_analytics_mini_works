shots <- data %>%
filter(teamId == 14 & result == 1 & h_a == 0 & pts > 2) %>%
select(scored, missed, )
shots
colour_factor = factor(data$sp,levels = c("Scored","Missed"),labels=c("Scored","Missed"))
ggplot(data, aes(x="",y=colour_factor,fill=colour_factor))+geom_bar(width=25,stat ='identity')+coord_polar("y",start=0)
shots <- data %>%
filter(teamId == 14 & result == 1 & h_a == 0 & pts > 2) %>%
select(scored, missed, X)
shots
colour_factor = factor(data$sp,levels = c("Scored","Missed"),labels=c("Scored","Missed"))
ggplot(data, aes(x="",y=colour_factor,fill=colour_factor))+geom_bar(width=25,stat ='identity')+coord_polar("y",start=0)
shots <- data %>%
filter(teamId == 14 & result == 1 & h_a == 0 & xpts > 2) %>%
select(scored, missed, X)
shots
colour_factor = factor(data$sp,levels = c("Scored","Missed"),labels=c("Scored","Missed"))
ggplot(data, aes(x="",y=colour_factor,fill=colour_factor))+geom_bar(width=25,stat ='identity')+coord_polar("y",start=0)
shots <- data %>%
filter(teamId == 14 & result == 1 & h_a == 0 & xpts > 2.5) %>%
select(scored, missed, X)
shots
colour_factor = factor(data$sp,levels = c("Scored","Missed"),labels=c("Scored","Missed"))
ggplot(data, aes(x="",y=colour_factor,fill=colour_factor))+geom_bar(width=25,stat ='identity')+coord_polar("y",start=0)
shots <- data %>%
filter(teamId == 14 & result == 1 & h_a == 0 & xpts > 2.1) %>%
select(scored, missed, X, xpts)
shots
colour_factor = factor(data$sp,levels = c("Scored","Missed"),labels=c("Scored","Missed"))
ggplot(data, aes(x="",y=colour_factor,fill=colour_factor))+geom_bar(width=25,stat ='identity')+coord_polar("y",start=0)
shots <- data %>%
filter(teamId == 14 & result == 1 & h_a == 0 & xpts > 2.1) %>%
select(scored, missed)
shots
colour_factor = factor(data$sp,levels = c("Scored","Missed"),labels=c("Scored","Missed"))
ggplot(data, aes(x="",y=colour_factor,fill=colour_factor))+geom_bar(width=25,stat ='identity')+coord_polar("y",start=0)
shots <- data %>%
filter(teamId == 14 & result == 1 & h_a == 0 & xpts > 2.1) %>%
select(scored, missed)
sub_intervals <- table(shots)
cbind(sub_intervals)
#colour_factor = factor(data$sp,levels = c("Scored","Missed"),labels=c("Scored","Missed"))
#ggplot(data, aes(x="",y=colour_factor,fill=colour_factor))+geom_bar(width=25,stat ='identity')+coord_polar("y",start=0)
shots <- data %>%
filter(teamId == 14 & result == 1 & h_a == 0 & xpts > 2.1) %>%
select(scored, missed)
shots
colour_factor = factor(data$sp,levels = c("Scored","Missed"),labels=c("Scored","Missed"))
ggplot(data, aes(x="",y=colour_factor,fill=colour_factor))+geom_bar(width=25,stat ='identity')+coord_polar("y",start=0)
shots <- data %>%
filter(teamId == 14 & result == 1 & h_a == 0 & xpts > 2.1) %>%
select(scored, missed)
shots
shots %>%
select(scored,missed) %>%
pivot_longer(cols = names(.)) %>%
ggplot(aes(x = value, y = 1, fill = name)) +
geom_col(position = "stack") +
coord_polar() +
theme_void()
#colour_factor = factor(data$sp,levels = c("Scored","Missed"),labels=c("Scored","Missed"))
#ggplot(data, aes(x="",y=colour_factor,fill=colour_factor))+geom_bar(width=25,stat ='identity')+coord_polar("y",start=0)
shots <- data %>%
filter(teamId == 14 & result == 1 & h_a == 0 & xpts > 2.1) %>%
select(scored, missed)
shots
shots %>%
select(scored,missed) %>%
pivot_longer(cols = names(.)) %>%
ggplot(aes(x = value, fill = name)) +
geom_col(position = "stack") +
coord_polar() +
theme_void()
shots <- data %>%
filter(teamId == 14 & result == 1 & h_a == 0 & xpts > 2.1) %>%
select(scored, missed)
shots
shots %>%
select(scored,missed) %>%
pivot_longer(cols = names(.)) %>%
ggplot(aes(x = scored, y = missed, fill = name)) +
geom_col(position = "stack") +
coord_polar() +
theme_void()
shots <- data %>%
filter(teamId == 14 & result == 1 & h_a == 0 & xpts > 2.1) %>%
select(scored, missed)
shots
shots %>%
select(scored,missed) %>%
pivot_longer(cols = names(.)) %>%
ggplot(aes(x = shots$scored, y = shots$missed, fill = name)) +
geom_col(position = "stack") +
coord_polar() +
theme_void()
#colour_factor = factor(data$sp,levels = c("Scored","Missed"),labels=c("Scored","Missed"))
#ggplot(data, aes(x="",y=colour_factor,fill=colour_factor))+geom_bar(width=25,stat ='identity')+coord_polar("y",start=0)
shots <- data %>%
filter(teamId == 14 & result == 1 & h_a == 0 & xpts > 2.1) %>%
select(scored, missed)
shots
shots %>%
select(scored,missed) %>%
pivot_longer(cols = names(.)) %>%
ggplot(aes(x = shots$scored, y = 1, fill = name)) +
geom_col(position = "stack") +
coord_polar() +
theme_void()
#colour_factor = factor(data$sp,levels = c("Scored","Missed"),labels=c("Scored","Missed"))
#ggplot(data, aes(x="",y=colour_factor,fill=colour_factor))+geom_bar(width=25,stat ='identity')+coord_polar("y",start=0)
shots <- data %>%
filter(teamId == 14 & result == 1 & h_a == 0 & xpts > 2.1) %>%
select(scored, missed)
shots
shots %>%
select(scored,missed) %>%
pivot_longer(cols = names(.)) %>%
ggplot(aes(x = value, y = 1, fill = name)) +
geom_col(position = "stack") +
coord_polar() +
theme_void()
#colour_factor = factor(data$sp,levels = c("Scored","Missed"),labels=c("Scored","Missed"))
#ggplot(data, aes(x="",y=colour_factor,fill=colour_factor))+geom_bar(width=25,stat ='identity')+coord_polar("y",start=0)
shots <- data %>%
filter(teamId == 14 & result == 1 & h_a == 0 & xpts > 2.1) %>%
select(scored, missed)
shots
pie(table(shots))
#colour_factor = factor(data$sp,levels = c("Scored","Missed"),labels=c("Scored","Missed"))
#ggplot(data, aes(x="",y=colour_factor,fill=colour_factor))+geom_bar(width=25,stat ='identity')+coord_polar("y",start=0)
shots <- data %>%
filter(teamId == 14 & result == 1 & h_a == 0 & xpts > 2.1) %>%
select(scored, missed)
shots
pie(table(shots), main="Male Left Handers Smoking Habits", col=rainbow(length(unique(newsurvey$Smoke))), radius=1)
shots <- data %>%
filter(teamId == 14 & result == 1 & h_a == 0 & xpts > 2.1) %>%
select(scored, missed)
shots
pie(table(shots), main="Male Left Handers Smoking Habits", col=rainbow(2), radius=1)
#colour_factor = factor(data$sp,levels = c("Scored","Missed"),labels=c("Scored","Missed"))
#ggplot(data, aes(x="",y=colour_factor,fill=colour_factor))+geom_bar(width=25,stat ='identity')+coord_polar("y",start=0)
shots <- data %>%
filter(teamId == 14 & result == 1 & h_a == 0 & xpts > 2.1) %>%
select(scored, missed)
shots
shots <- cbind(shots)
pie(table(shots), main="scored and missed", col=rainbow(2), radius=1)
#colour_factor = factor(data$sp,levels = c("Scored","Missed"),labels=c("Scored","Missed"))
#ggplot(data, aes(x="",y=colour_factor,fill=colour_factor))+geom_bar(width=25,stat ='identity')+coord_polar("y",start=0)
shots <- data %>%
filter(teamId == 14 & result == 1 & h_a == 0 & xpts > 2.1) %>%
select(scored, missed)
shots <- cbind(shots)
shots
pie(table(shots), main="scored and missed", col=rainbow(2), radius=1)
#colour_factor = factor(data$sp,levels = c("Scored","Missed"),labels=c("Scored","Missed"))
#ggplot(data, aes(x="",y=colour_factor,fill=colour_factor))+geom_bar(width=25,stat ='identity')+coord_polar("y",start=0)
shots <- data %>%
filter(teamId == 14 & result == 1 & h_a == 0 & xpts > 2.1) %>%
select(scored, missed)
shots
barplot(shots, main = 'Female Left Handers and Male Left Handers', ylab = 'count', col=rainbow(2))
shots <- data %>%
filter(teamId == 14 & result == 1 & h_a == 0 & xpts > 2.1) %>%
select(scored, missed)
shots
barplot(shots$scored, main = 'Female Left Handers and Male Left Handers', ylab = 'count', col=rainbow(2))
shots <- data %>%
filter(teamId == 14 & result == 1 & h_a == 0 & xpts > 2.1) %>%
select(scored, missed)
shots <- as.data.frame(shots)
barplot(shots$scored, main = 'Female Left Handers and Male Left Handers', ylab = 'count', col=rainbow(2))
shots <- data %>%
filter(teamId == 14 & result == 1 & h_a == 0 & xpts > 2.1) %>%
select(scored, missed)
shots <- as.data.frame(shots)
shots
barplot(shots, main = 'Female Left Handers and Male Left Handers', ylab = 'count', col=rainbow(2))
shots <- data %>%
filter(teamId == 14 & result == 1 & h_a == 0 & xpts > 2.1) %>%
select(result)
shots
barplot(shots, main = 'Female Left Handers and Male Left Handers', ylab = 'count', col=rainbow(2))
shots <- data %>%
filter(teamId == 14 & h_a == 0) %>%
select(result)
shots
barplot(shots, main = 'Female Left Handers and Male Left Handers', ylab = 'count', col=rainbow(2))
shots <- data %>%
filter(teamId == 14 & h_a == 0) %>%
select(result)
shots
barplot(shots$result, main = 'Female Left Handers and Male Left Handers', ylab = 'count', col=rainbow(2))
shots <- data %>%
filter(teamId == 14 & h_a == 0) %>%
select(result)
shots
pie(shots$result, main = 'Female Left Handers and Male Left Handers', ylab = 'count', col=rainbow(2))
shots <- data %>%
filter(teamId == 14 & h_a == 0) %>%
select(result)
shots
pie(table(shots$result), main = 'Female Left Handers and Male Left Handers', col=rainbow(2))
shots <- data %>%
filter(teamId == 14 & h_a == 0) %>%
select(result)
shots
pie(table(shots$result), main = 'Female Left Handers and Male Left Handers', col=rainbow(3))
#hist(data$teamId, main = "result distribution", xlab = "team name", ylab = "frequency")
ggplot(data,aes(x=teamId))+geom_bar()+ggtitle("Male and Female participants")
#hist(data$teamId, main = "result distribution", xlab = "team name", ylab = "frequency")
ggplot(data$wins,aes(x=teamId))+geom_bar()+ggtitle("Male and Female participants")
#hist(data$teamId, main = "result distribution", xlab = "team name", ylab = "frequency")
ggplot(data,aes(x=teamId))+geom_bar()+ggtitle("Male and Female participants")
#hist(data$teamId, main = "result distribution", xlab = "team name", ylab = "frequency")
df1 <- data %>%
filter(result == 1)
ggplot(data,aes(x=teamId))+geom_bar()+ggtitle("Male and Female participants")
#hist(data$teamId, main = "result distribution", xlab = "team name", ylab = "frequency")
df1 <- data %>%
filter(result == 1)
ggplot(df1,aes(x=teamId))+geom_bar()+ggtitle("Male and Female participants")
#hist(data$teamId, main = "result distribution", xlab = "team name", ylab = "frequency")
df1 <- data %>%
filter(result == 1)
ggplot(df1,aes(x=teamId))+geom_bar()+ggtitle("Total wins for each team")
df2 <- data %>%
filter(result == -1)
ggplot(df2,aes(x=teamId))+geom_bar()+ggtitle("Total loss for each team")
# teamId = 0 corresponds to Liverpool
densityplot(data$ppda_cal)
library(lattice)
library(e1071)
library(dplyr)
library(caret)
library(ggplot2)
library(lattice)
library(e1071)
print(paste("Skewness = ", skewness(data$ppda_cal)))
print(paste("Kurtosis = ", kurtosis(data$ppda_cal)))
print(paste("Skewness = ", skewness(data$ppda_cal)))
print(paste("Kurtosis = ", kurtosis(data$ppda_cal)))
# This means mean is greater than median greater than mode
# Leptokurtic becasue of the positive value
boxplot(data$ppda_cal, main="ppda_cal boxplot", ylab = "ppda_cal")
cols = colnames(data)
for (c in cols) {
print(paste("Column", c, ": ", cor(data[[c]],data$xG)))
}
cols = colnames(data)
for (c in cols) {
print(paste("Column", c, ": ", cov(data[[c]],data$xG)))
}
ggplot(data, aes(x=HtrgPerc,y=result))+geom_boxplot(fill = "#FF6633")
df3 <- mutate(data$result = as.character(data$result))
mutate(data$result = as.character(data$result))
data[data$result==-1, 'result'] <- as.character("loss")
data[data$result==1, 'result'] <- as.character("win")
data[data$result==0, 'result'] <- as.character("draw")
data$res2 = as.character(as.numeric(data$teamId))
mutate(data$res2 = as.character(data$result))
data[data$result==-1, 'result'] <- as.character("loss")
data[data$result==1, 'result'] <- as.character("win")
data[data$result==0, 'result'] <- as.character("draw")
data$res2 = as.character(as.numeric(data$teamId))
ggplot(data, aes(x=HtrgPerc,y=res2))+geom_boxplot(fill = "#FF6633")
str(data)
knitr::opts_chunk$set(echo = TRUE)
data <- read.csv("epl2020.csv")
head(data)
str(data)
print("Dimension: ")
dim(data)
colnames(data)
unique(data["teamId"])
unique(data["h_a"])
unique(data["result"])
data[data$teamId=="Liverpool", 'teamId'] <- as.numeric(0)
data[data$teamId=="Norwich", 'teamId'] <- as.numeric(1)
data[data$teamId=="Man City", 'teamId'] <- as.numeric(2)
data[data$teamId=="West Ham", 'teamId'] <- as.numeric(3)
data[data$teamId=="Bournemouth", 'teamId'] <- as.numeric(4)
data[data$teamId=="Brighton", 'teamId'] <- as.numeric(5)
data[data$teamId=="Burnley", 'teamId'] <- as.numeric(6)
data[data$teamId=="Crystal Palace", 'teamId'] <- as.numeric(7)
data[data$teamId=="Everton", 'teamId'] <- as.numeric(8)
data[data$teamId=="Sheffield United", 'teamId'] <- as.numeric(9)
data[data$teamId=="Southampton", 'teamId'] <- as.numeric(10)
data[data$teamId=="Watford", 'teamId'] <- as.numeric(11)
data[data$teamId=="Aston Villa", 'teamId'] <- as.numeric(12)
data[data$teamId=="Tottenham", 'teamId'] <- as.numeric(13)
data[data$teamId=="Arsenal", 'teamId'] <- as.numeric(14)
data[data$teamId=="Leicester", 'teamId'] <- as.numeric(15)
data[data$teamId=="Newcastle United", 'teamId'] <- as.numeric(16)
data[data$teamId=="Wolves", 'teamId'] <- as.numeric(17)
data[data$teamId=="Chelsea", 'teamId'] <- as.numeric(18)
data[data$teamId=="Man Utd", 'teamId'] <- as.numeric(19)
data[data$h_a=="h", 'h_a'] <- as.numeric(1)
data[data$h_a=="a", 'h_a'] <- as.numeric(0)
data[data$result=="w", 'result'] <- as.numeric(1)
data[data$result=="d", 'result'] <- as.numeric(0)
data[data$result=="l", 'result'] <- as.numeric(-1)
data$teamId = as.numeric(as.character(data$teamId))
data$h_a = as.numeric(as.character(data$h_a))
data$result = as.numeric(as.character(data$result))
head(data, 7)
str(data)
# Remove the 2 columns:
data <- subset(data, select = -c(matchDay, Referee.x, date))
str(data)
library(tidyverse)
print(paste("Number of missing values = ", sum(is.na(data))))
print(paste("Number of duplicate entries = ", sum(duplicated(data))))
summary(data)
library(dplyr)
library(caret)
library(ggplot2)
library(lattice)
library(e1071)
# Arsenal team ID is 14
arsenal_l <- data%>%
filter(teamId == 14 & h_a == 1 & result == -1)
arsenal_d <- data%>%
filter(teamId == 14 & h_a == 1 & result == 0)
arsenal_w <- data%>%
filter(teamId == 14 & h_a == 1 & result == 1)
print(paste("Total victory: ", count(arsenal_w)))
print(paste("Total draw: ", count(arsenal_d)))
print(paste("Total loss: ", count(arsenal_l)))
shots <- data %>%
filter(teamId == 14 & h_a == 0) %>%
select(result)
shots
pie(table(shots$result), main = 'Female Left Handers and Male Left Handers', col=rainbow(3))
# 0 -> draw, 1 -> win and -1 -> loss of the game
# Find the total number of wins and see which team has the highest value
df1 <- data %>%
filter(result == 1)
ggplot(df1,aes(x=teamId))+geom_bar()+ggtitle("Total wins for each team")
# teamId = 0 corresponds to Liverpool
df2 <- data %>%
filter(result == -1)
ggplot(df2,aes(x=teamId))+geom_bar()+ggtitle("Total loss for each team")
# teamId = 1 corresponds to Norwich
densityplot(data$ppda_cal)
print(paste("Skewness = ", skewness(data$ppda_cal)))
print(paste("Kurtosis = ", kurtosis(data$ppda_cal)))
# This means mean is greater than median greater than mode
# Leptokurtic becasue of the positive value
boxplot(data$ppda_cal, main="ppda_cal boxplot", ylab = "ppda_cal")
data[data$res2==-1, 'result'] <- as.character("loss")
data[data$res2==1, 'result'] <- as.character("win")
data[data$res2==0, 'result'] <- as.character("draw")
data$res2 = as.character(as.numeric(data$teamId))
ggplot(data, aes(x=HtrgPerc,y=res2))+geom_boxplot(fill = "#FF6633")
knitr::opts_chunk$set(echo = TRUE)
data <- read.csv("epl2020.csv")
head(data)
str(data)
print("Dimension: ")
dim(data)
colnames(data)
unique(data["teamId"])
unique(data["h_a"])
unique(data["result"])
data[data$teamId=="Liverpool", 'teamId'] <- as.numeric(0)
data[data$teamId=="Norwich", 'teamId'] <- as.numeric(1)
data[data$teamId=="Man City", 'teamId'] <- as.numeric(2)
data[data$teamId=="West Ham", 'teamId'] <- as.numeric(3)
data[data$teamId=="Bournemouth", 'teamId'] <- as.numeric(4)
data[data$teamId=="Brighton", 'teamId'] <- as.numeric(5)
data[data$teamId=="Burnley", 'teamId'] <- as.numeric(6)
data[data$teamId=="Crystal Palace", 'teamId'] <- as.numeric(7)
data[data$teamId=="Everton", 'teamId'] <- as.numeric(8)
data[data$teamId=="Sheffield United", 'teamId'] <- as.numeric(9)
data[data$teamId=="Southampton", 'teamId'] <- as.numeric(10)
data[data$teamId=="Watford", 'teamId'] <- as.numeric(11)
data[data$teamId=="Aston Villa", 'teamId'] <- as.numeric(12)
data[data$teamId=="Tottenham", 'teamId'] <- as.numeric(13)
data[data$teamId=="Arsenal", 'teamId'] <- as.numeric(14)
data[data$teamId=="Leicester", 'teamId'] <- as.numeric(15)
data[data$teamId=="Newcastle United", 'teamId'] <- as.numeric(16)
data[data$teamId=="Wolves", 'teamId'] <- as.numeric(17)
data[data$teamId=="Chelsea", 'teamId'] <- as.numeric(18)
data[data$teamId=="Man Utd", 'teamId'] <- as.numeric(19)
data[data$h_a=="h", 'h_a'] <- as.numeric(1)
data[data$h_a=="a", 'h_a'] <- as.numeric(0)
data[data$result=="w", 'result'] <- as.numeric(1)
data[data$result=="d", 'result'] <- as.numeric(0)
data[data$result=="l", 'result'] <- as.numeric(-1)
data$teamId = as.numeric(as.character(data$teamId))
data$h_a = as.numeric(as.character(data$h_a))
data$result = as.numeric(as.character(data$result))
head(data, 7)
str(data)
# Remove the 2 columns:
data <- subset(data, select = -c(matchDay, Referee.x, date))
str(data)
library(tidyverse)
print(paste("Number of missing values = ", sum(is.na(data))))
print(paste("Number of duplicate entries = ", sum(duplicated(data))))
summary(data)
library(dplyr)
library(caret)
library(ggplot2)
library(lattice)
library(e1071)
# Arsenal team ID is 14
arsenal_l <- data%>%
filter(teamId == 14 & h_a == 1 & result == -1)
arsenal_d <- data%>%
filter(teamId == 14 & h_a == 1 & result == 0)
arsenal_w <- data%>%
filter(teamId == 14 & h_a == 1 & result == 1)
print(paste("Total victory: ", count(arsenal_w)))
print(paste("Total draw: ", count(arsenal_d)))
print(paste("Total loss: ", count(arsenal_l)))
shots <- data %>%
filter(teamId == 14 & h_a == 0) %>%
select(result)
shots
pie(table(shots$result), main = 'Female Left Handers and Male Left Handers', col=rainbow(3))
# 0 -> draw, 1 -> win and -1 -> loss of the game
# Find the total number of wins and see which team has the highest value
df1 <- data %>%
filter(result == 1)
ggplot(df1,aes(x=teamId))+geom_bar()+ggtitle("Total wins for each team")
# teamId = 0 corresponds to Liverpool
df2 <- data %>%
filter(result == -1)
ggplot(df2,aes(x=teamId))+geom_bar()+ggtitle("Total loss for each team")
# teamId = 1 corresponds to Norwich
densityplot(data$ppda_cal)
print(paste("Skewness = ", skewness(data$ppda_cal)))
print(paste("Kurtosis = ", kurtosis(data$ppda_cal)))
# This means mean is greater than median greater than mode
# Leptokurtic becasue of the positive value
boxplot(data[, 3:6], main="Multiple-boxplot for EPL dataset", ylab = "units")
str(data)
mean_charge <- mean(data$xG)
median_charge <- median(data$xG)
var_charge <- var(data$xG)
sd_charge <- sd(data$xG)
print(paste("mean_xG = ", mean_charge))
print(paste("median_xG = ", median_charge))
print(paste("var_xG = ", var_charge))
print(paste("sd_xG = ", sd_charge))
gf = factor(data$result,levels = c("-1","0","1"),labels = c("loss","win","draw"))
ggplot(df,aes(x=xG,fill=h_a))+geom_histogram(binwidth = 1)+labs(title = "Distribution of height",y='Frequency')+facet_wrap(gf,ncol=2)
gf = factor(data$result,levels = c("-1","0","1"),labels = c("loss","win","draw"))
ggplot(data,aes(x=xG,fill=h_a))+geom_histogram(binwidth = 1)+labs(title = "Distribution of height",y='Frequency')+facet_wrap(gf,ncol=2)
gf = factor(data$result,levels = c("-1","0","1"),labels = c("loss","win","draw"))
ggplot(data,aes(x=xG,fill=h_a))+geom_histogram(binwidth = 1)+labs(title = "Distribution of height",y='Frequency')+facet_wrap(gf,ncol=2)
ggplot(data, aes(x=npxG,y=xG))+geom_point()
pairs(data[, cols])
pairs(data[, c("AS.x", "npxG", "deep", "scored", "wins", "draw", "npxGD", "pts", "allowed_ppda")])
pairs(data[, c("AS.x", "npxG", "deep", "scored", "wins", "draws", "npxGD", "pts", "allowed_ppda")])
model1 <- lm(xG~.,data=data)
model1
summary(model1)
sigma(model1)
confint(model1)
plot(model1, 1)
par(mar=c(2,2,2,2))
hist(model1$residuals)
qqnorm(model1$residuals,ylab = "Residuals")
qqline(model1$residuals)
sig_data = subset(data, select = c(xGA, npxG, npxGA, deep, deep_allowed, scored, missed, xpts, result, HC.x))
str(sig_data)
ggplot(data,aes(x=xGA,y=xG))+geom_point()+geom_smooth()
ggplot(data,aes(x=xG,y=xGA))+geom_point()+geom_smooth()
ggplot(data,aes(x=xG,y=npxG))+geom_point()+geom_smooth(method='lm',se=FALSE)
ggplot(data,aes(x=xG,y=npxGA))+geom_point()+geom_smooth(method='lm',se=FALSE)
ggplot(data,aes(x=xG,y=deep))+geom_point()+geom_smooth(method='lm',se=FALSE)
ggplot(data,aes(x=xG,y=deep_allowed))+geom_point()+geom_smooth(method='lm',se=FALSE)
ggplot(data,aes(x=xG,y=scored))+geom_point()+geom_smooth(method='lm',se=FALSE)
ggplot(data,aes(x=xG,y=missed))+geom_point()+geom_smooth(method='lm',se=FALSE)
ggplot(data,aes(x=xG,y=xpts))+geom_point()+geom_smooth(method='lm',se=FALSE)
ggplot(data,aes(x=xG,y=result))+geom_point()+geom_smooth(method='lm',se=FALSE)
ggplot(data,aes(x=xG,y=result))+geom_point()+geom_smooth(method='lm')
ggplot(data,aes(x=xG,y=HC.x))+geom_point()+geom_smooth(method='lm')
set.seed(123)
train_samples <- sig_data$xG %>%
createDataPartition(p=0.8,list=FALSE)
head(train_samples)
sig_data = subset(data, select = c(xG, xGA, npxG, npxGA, deep, deep_allowed, scored, missed, xpts, result, HC.x))
str(sig_data)
set.seed(123)
train_samples <- sig_data$xG %>%
createDataPartition(p=0.8,list=FALSE)
head(train_samples)
train <- sig_data[train_samples,]
test <- sig_data[-train_samples,]
model2 <- lm(charges~.,data=train)
train <- sig_data[train_samples,]
test <- sig_data[-train_samples,]
model2 <- lm(xG~.,data=train)
summary(model2)
sigma(model2)
confint(model2)
plot(model2, 1)
par(mar=c(2,2,2,2))
hist(model2$residuals)
qqnorm(model2$residuals,ylab = "Residuals")
qqline(model2$residuals)
pred <- model2 %>%
predict(test)
R2 <- R2(pred,test$xG)
R2
RMSE <- RMSE(pred,test$xG)
RMSE
